# Region of interest analysis of MEMRI signal intensities and c-fos IHC cell count data

## Overview
This section contains R markdown files used in the analysis of ROIs from MEMRI images and their correlations with measurements from  micrographs of c-fos+ stained cells. 

Please see the **[Bearer Lab ROI Measurement Repo](https://github.com/bearerlab/memri-roi-measurement)** for more detailed information and instructions on use. Briefly, ROI anatomy is identified and notated manually by users, input images are organized in a directory. User-modified feeder script provides ROI information to subsequent scripts for intensity measurements and generation of a CSV file that compiles ROI information from across a large dataset of NIfTI images. For instance, in Fig. 3, we measured intensity statistics from 8 ROIs, in 23 mice separated into 2 groups (Std and ELA), and across 3 conditions (BL-PreMn, HC, and TMT). R Markdown files provide code used for data curation for statistical analysis and graphical visualization.

**Associated Figures/Tables:**
- Figure 3-4 (ROI comparisons of signal intensity magnitudes, and Comparisons to c-fos+ staining)
- Supplemental Figures S4-6 (test-retest, bootstrapped correlations, effects of smoothing)
- Supplemental Tables S2-4 (ROI locations - for Fig. 3, and statistical summaries)

## Directory Structure

Note: Files/Scripts listed below are placed in order of processing/analysis steps - intermingled between sub-directories, and not necessarily in alphanumeric order.

```
02_roi_analysis/
├── SNR_memri_analysis.Rmd          # R markdown file for Signal-to-Noise Ratio Analysis
├── Fig3_analysis.Rmd               # R markdown file for comparisons in Fig. 3
├── Fig4_analysis.Rmd               # R markdown file for comparisons in Fig. 4
└── memri_test_retest_analysis.Rmd  # R markdown file for supplmental test-retest  
```

## Script Descriptions

### ROI Measurement Scripts (non-specific)

For a general description of ROI measurement scripts, please refer to the Bearer Lab GitHub repository.

[ROI Scripts Repo](https://github.com/bearerlab/memri-roi-measurement)

### ROI Analysis Markdown Files 

#### `SNR_memri_analysis.Rmd`
**Purpose:** To statistically compare and visualize SNR between groups - test whether there is a difference in MnCl2 dose via differences in SNR.

**Dependencies:** R/RStudio (see [requirements]{../requirements/requirements.md}).

**Usage:** Knit R Markdown File in R Studio

**Inputs:** CSV file generated by running ./ROI_feeder.sh 

**Outputs:** Statistical summaries and plots shown in Fig. S2D.

#### `Fig3_analysis.Rmd`
**Purpose:** To perform comparisons described in the results text for Fig. 3. Comparison of threat-activated regions within the ELA group (A) and between groups (B).  

**Dependencies:** R/RStudio (see 

**Usage:** Knit R Markdown File in R Studio

**Inputs:** CSV file generated by running ./ROI_feeder.sh 

**Outputs:** Statistical summaries and plots shown in Fig. 3 and Tables S3-4.

#### `Fig4_cfos_analysis.Rmd`
**Purpose:** To compare signal intensities and c-fos counts between regions of high and low signal/staining and to perform between-modality correlations.

**Dependencies:** R/RStudio (see [requirements]{../requirements/requirements.md}).

**Usage:** Knit R Markdown File in R Studio

**Inputs:** CSV files generated by running ./ROI_feeder_cfos.sh and by performing cfos+ counts manually.

**Outputs:** Statistical summaries and plots shown in Fig. 4 and S5.

#### `memri_test_retest_analysis.Rmd`
**Purpose:** To test differences in MEMRI signal intensities as in Fig, 4, but on the other subset of mice whose brains were not processed for histology.

**Dependencies:** R/RStudio (see [requirements]{../requirements/requirements.md}).

**Usage:** Knit R Markdown File in R Studio

**Inputs:** CSV file generated by running ./ROI_feeder.sh 

**Outputs:** Statistical summaries and plots shown in Fig. S2D.

